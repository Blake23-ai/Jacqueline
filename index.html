
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Little Yellow Bird — Pink Poles</title>
  <style>
    html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif;background:#bfe9ff}
    #gameWrap{display:flex;align-items:center;justify-content:center;height:100vh}
    canvas{border-radius:10px;box-shadow:0 8px 24px rgba(0,0,0,0.18)}

    .controls{position:fixed;left:16px;bottom:16px;background:rgba(255,255,255,0.9);padding:10px;border-radius:8px;font-size:14px}
    .controls b{display:block}
  </style>
</head>
<body>
  <div id="gameWrap">
    <canvas id="game" width="800" height="500" aria-label="Little Yellow Bird game"></canvas>
  </div>

  <div class="controls">
    <b>Controls</b>
    Space / Click / Tap — flap
  </div>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const W = canvas.width; const H = canvas.height;

    let bird, pipes, frame, speed, bgOffset, gameOver, score, highScore;

    const pipeWidth = 60;
    const gapSize = 150;

    const birdColor = '#ffd800';
    const pipeColor = '#ff8fcf';
    const skyTop = '#bfe9ff';

    function resetGame(){
      bird = { x: 120, y: H/2, w: 34, h: 24, vy:0, gravity:0.55, flapPower:-9 };
      pipes = [];
      frame = 0;
      speed = 2.6;
      bgOffset = 0;
      gameOver = false;
      score = 0;
      spawnPipe();
    }

    function spawnPipe(){
      const minTop = 30;
      const maxTop = H - gapSize - 30;
      const topHeight = Math.floor(Math.random() * (maxTop - minTop + 1)) + minTop;
      const pipe = { x: W + 20, top: topHeight, passed: false };
      pipes.push(pipe);
    }

    function flap(){
      if(gameOver){
        resetGame();
        return;
      }
      bird.vy = bird.flapPower;
    }

    window.addEventListener('keydown', e => { if(e.code === 'Space') { e.preventDefault(); flap(); } });
    canvas.addEventListener('mousedown', flap);
    canvas.addEventListener('touchstart', e => { e.preventDefault(); flap(); }, {passive:false});

    function collides(pipe){
      const bx1 = bird.x - bird.w/2; const bx2 = bird.x + bird.w/2;
      const by1 = bird.y - bird.h/2; const by2 = bird.y + bird.h/2;
      const px1 = pipe.x; const px2 = pipe.x + pipeWidth;
      const topY2 = pipe.top;
      const botY1 = pipe.top + gapSize;
      const overlapX = !(bx2 < px1 || bx1 > px2);
      const hitTop = overlapX && by1 < topY2;
      const hitBottom = overlapX && by2 > botY1;
      return hitTop || hitBottom;
    }

    function update(){
      if(gameOver) return;
      frame++;
      bgOffset = (bgOffset - speed*0.4) % W;

      bird.vy += bird.gravity;
      bird.y += bird.vy;

      if(bird.y - bird.h/2 < 0){ bird.y = bird.h/2; bird.vy = 0; }
      if(bird.y + bird.h/2 > H){ bird.y = H - bird.h/2; bird.vy = 0; gameOver = true; }

      if(frame % 110 === 0) spawnPipe();

      for(let i = pipes.length-1; i>=0; i--){
        const p = pipes[i];
        p.x -= speed;
        if(!p.passed && p.x + pipeWidth < bird.x - bird.w/2){ p.passed = true; score++; }
        if(collides(p)) { gameOver = true; }
        if(p.x + pipeWidth < -50) pipes.splice(i,1);
      }

      if(gameOver){
        if(highScore === undefined) highScore = score;
        else highScore = Math.max(highScore, score);
      }
    }

    function drawBackground(){
      const g = ctx.createLinearGradient(0,0,0,H);
      g.addColorStop(0, skyTop);
      g.addColorStop(1, '#e9f9ff');
      ctx.fillStyle = g;
      ctx.fillRect(0,0,W,H);

      const cloudCount = 5;
      for(let i=0;i<cloudCount;i++){
        const cx = ((i*260 + bgOffset*0.6) % (W+300)) - 150;
        const cy = 50 + (i%3)*40;
        drawCloud(cx, cy, 60 + (i%3)*12);
      }
    }
    function drawCloud(x,y,size){
      ctx.beginPath();
      ctx.fillStyle = 'rgba(255,255,255,0.9)';
      ctx.arc(x,y,size*0.5,0,Math.PI*2);
      ctx.arc(x+size*0.45,y-size*0.1,size*0.35,0,Math.PI*2);
      ctx.arc(x-size*0.45,y-size*0.12,size*0.38,0,Math.PI*2);
      ctx.fill();
    }

    function drawPipes(){
      ctx.fillStyle = pipeColor;
      for(const p of pipes){
        ctx.fillRect(Math.round(p.x), 0, pipeWidth, Math.round(p.top));
        ctx.fillRect(Math.round(p.x), Math.round(p.top + gapSize), pipeWidth, H - (p.top + gapSize));
        ctx.fillStyle = '#ff74b3';
        ctx.fillRect(Math.round(p.x)-2, Math.round(p.top)-6, pipeWidth+4, 6);
        ctx.fillRect(Math.round(p.x)-2, Math.round(p.top + gapSize), pipeWidth+4, 6);
        ctx.fillStyle = pipeColor;
      }
    }

    function drawBird(){
      const cx = bird.x; const cy = bird.y;
      ctx.save();
      ctx.translate(cx, cy);
      const angle = Math.max(-0.6, Math.min(0.8, bird.vy * 0.03));
      ctx.rotate(angle);

      ctx.beginPath();
      ctx.ellipse(0,0,bird.w/2,bird.h/2,0,0,Math.PI*2);
      ctx.fillStyle = birdColor;
      ctx.fill();

      ctx.beginPath(); ctx.arc(6,-3,3,0,Math.PI*2); ctx.fillStyle='#000'; ctx.fill();
      ctx.beginPath(); ctx.arc(7,-3,1.2,0,Math.PI*2); ctx.fillStyle='#fff'; ctx.fill();

      ctx.beginPath(); ctx.moveTo(-2,4); ctx.lineTo(10,2); ctx.lineTo(-2,0); ctx.closePath(); ctx.fillStyle='#ffb84d'; ctx.fill();

      ctx.beginPath(); ctx.ellipse(-4,3,6,3,-0.6,0,Math.PI*2); ctx.fillStyle='#ffdb4d'; ctx.fill();
      ctx.restore();
    }

    function drawScore(){
      ctx.fillStyle = '#036';
      ctx.font = '22px system-ui, Arial';
      ctx.textAlign = 'left';
      ctx.fillText('Score: ' + score, 14, 28);
    }

    function drawGameOver(){
      if(!gameOver) return;
      ctx.fillStyle = '#0074e8';
      ctx.font = 'bold 56px system-ui, Arial';
      ctx.textAlign = 'center';
      ctx.fillText('Game Over', W/2, H/2 - 30);

      ctx.font = '22px system-ui, Arial';
      ctx.fillText('Your Score: ' + score, W/2, H/2 + 10);
      if(highScore !== undefined){
        ctx.fillText('High Score: ' + highScore, W/2, H/2 + 40);
      }
      ctx.font = '18px system-ui, Arial';
      ctx.fillText('Press Space to Restart', W/2, H/2 + 70);
    }

    function loop(){
      update();
      drawBackground();
      drawPipes();
      drawBird();
      drawScore();
      drawGameOver();
      requestAnimationFrame(loop);
    }

    resetGame();
    loop();

    function resizeCanvas(){
      const maxW = Math.min(920, window.innerWidth - 40);
      const scale = Math.min(maxW / 800, (window.innerHeight - 120) / 500);
      const cssW = Math.round(800 * scale);
      const cssH = Math.round(500 * scale);
      canvas.style.width = cssW + 'px';
      canvas.style.height = cssH + 'px';
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    canvas.tabIndex = 0;
    canvas.style.outline = 'none';
    canvas.addEventListener('keydown', e => { if(e.code==='Space') flap(); });
  </script>
</body>
</html>
